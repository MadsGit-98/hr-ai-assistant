<!DOCTYPE html>
<html>
<head>
    <title>{% if object %}Edit{% else %}Create{% endif %} Job Listing</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-md">
            <h1 class="text-xl font-bold mb-6">{% if object %}Edit{% else %}Create{% endif %} Job Listing</h1>
            
            {% if messages %}
                {% for message in messages %}
                    <div class="mb-4 p-3 bg-{{ message.tags }}-100 text-{{ message.tags }}-700 rounded">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
            
            <form method="post" class="space-y-4">
                {% csrf_token %}
                
                <div class="mb-4">
                    <label for="{{ form.title.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Title *</label>
                    {{ form.title }}
                    {% if form.title.errors %}
                        <p class="text-red-600 text-sm mt-1">{{ form.title.errors }}</p>
                    {% endif %}
                    <p class="text-gray-500 text-xs mt-1">Maximum 200 characters</p>
                </div>
                
                <div class="mb-4">
                    <label for="{{ form.detailed_description.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Detailed Description</label>
                    {{ form.detailed_description }}
                    {% if form.detailed_description.errors %}
                        <p class="text-red-600 text-sm mt-1">{{ form.detailed_description.errors }}</p>
                    {% endif %}
                    <p class="text-gray-500 text-xs mt-1">Supports markdown formatting. Maximum 50,000 characters.</p>
                </div>
                
                <div class="mb-4">
                    <label for="{{ form.required_skills.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Required Skills</label>
                    {{ form.required_skills }}
                    {% if form.required_skills.errors %}
                        <p class="text-red-600 text-sm mt-1">{{ form.required_skills.errors }}</p>
                    {% endif %}
                    <p class="text-gray-500 text-xs mt-1">Enter skills as comma-separated values. Maximum 100 skills.</p>
                </div>
                
                <div class="mb-4 flex items-center">
                    {{ form.is_active }}
                    <label for="{{ form.is_active.id_for_label }}" class="ml-2 block text-sm text-gray-700">Active Listing</label>
                    {% if form.is_active.errors %}
                        <p class="text-red-600 text-sm ml-2">{{ form.is_active.errors }}</p>
                    {% endif %}
                </div>
                
                {% if object %}
                    <!-- Hidden field for optimistic locking to prevent concurrent editing (T035) -->
                    <input type="hidden" name="version" value="{{ object.modified_date.timestamp }}">
                {% endif %}
                
                <div class="flex flex-wrap gap-4">
                    <a href="{% url 'joblisting_list' %}" class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400">Cancel</a>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                        {% if object %}Update{% else %}Create{% endif %} Job Listing
                    </button>
                    <a href="{% url 'joblisting_list' %}" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                        Back to Job Listings
                    </a>
                </div>
            </form>
        </div>
    </div>
</body>
</html>